<html>
	<head>
		<script src="./three.min.js"></script>
		<script src="./listener.js"></script>
		<script src="./radialTree.js"></script>
		<script src="./room.js"></script>
		<script src="./block.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/3.5.1/math.js"></script>
	</head>
	<body>
		<script>


var scene = new THREE.Scene();
camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 1, 1000 );
//camera.position.set(0, 100, 250);

var renderer = new THREE.WebGLRenderer();
renderer.setSize( window.innerWidth, window.innerHeight );
//For spotlight
document.body.appendChild( renderer.domElement );

//Lighting
var ambient = new THREE.AmbientLight( 0xffffff, 0.6 );
//scene.add(ambient);

var pLight = new THREE.PointLight(new THREE.Color(1, 1, 0.9), 0.5, 100);
pLight.position.z = -20;
scene.add(pLight);

//scene.add(new THREE.PointLightHelper(greenPoint, 3));

w = 300;
h = 200;

var lightPoint = new THREE.PointLight(new THREE.Color(1, 1, 0.9), 1, 600);
lightPoint.position.set( w/2, h/2, 0 );
scene.add(lightPoint);

var lightPoint2 = new THREE.PointLight(new THREE.Color(1, 1, 1), 1.5, 400);
lightPoint2.position.set(0, w/2, 0);
scene.add(lightPoint2);	

group = new THREE.Object3D();
group.position.z -= h;
group.position.y -= h/2.75;

room(group);

cursor = cursorBlock(0, 0, 0);

var stack = [];
stack[0] = cursor;

group.add(cursor);

var rtree = tree();

group.add(rtree);
scene.add(group);

function render() {
	requestAnimationFrame( render );

	//group.rotation.y += 0.01;
	//radialTree.position.y=20;
	//radialTree.position.z=10;
	rtree.rotation.y += 0.01;
	//rtree.rotation.z += 0.01;

	camera.lookAt(scene.position);
	renderer.render( scene, camera );
}

function onKeyDown(e) {
	e = e || window.event;

   if (e.keyCode == '38') {
        // up arrow
        stack[0].position.z-=10;

    }
    else if (e.keyCode == '40') {
        // down arrow
        stack[0].position.z+=10;
    }
    else if (e.keyCode == '37') {
       // left arrow
       stack[0].position.x-=10;
    }
    else if (e.keyCode == '39') {
       // right arrow
       stack[0].position.x+=10;
    }else if (e.keyCode == 32) {
    	b = cursorBlock(0, 0, 0);
    	stack.unshift(b);
    	group.add(b);

    }

}

document.onkeydown = onKeyDown;

var cx = -100;
var cy = 50;
var cz = -10;

voiceListener(function(result) {
	cube(group, cx, cy, cz);
	cx+=20;
});

render();

			
		</script>
	</body>
</html>